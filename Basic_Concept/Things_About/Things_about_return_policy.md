# Return Policy

## RVO

RVO 的工作原理：当函数返回一个局部对象时，编译器可以将调用函数中的目标变量地址直接传递给被调用函数，从而避免创建临时对象。

这种优化适用于返回局部对象的函数，但不适用于返回多个可能的对象或重用现有变量的情况。

如何确保编译器执行 RVO：被调用函数应定义一个用于返回值的单一变量。调用函数应将返回值赋给一个新变量，而不是重用现有变量。

RVO 的限制：如果被调用函数使用多个变量作为返回值，RVO 不会发生。如果调用函数重用现有变量来存储返回值，RVO 不会发生（但移动语义可能适用）。

临时对象：RVO 也适用于临时对象，编译器可以优化掉临时对象的创建和复制。当函数返回一个临时对象时，RVO 仍然可以生效。

如果代码需要进行复制，那么就进行复制，不要为了优化而牺牲代码的正确性。
