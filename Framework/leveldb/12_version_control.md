# Version Control

**版本（Version）**:

- 每个版本代表了一个数据库状态的快照，包括当前磁盘和内存中的所有文件信息。
- 版本集（VersionSet）是所有版本的集合，负责版本间的管理和切换。
- 当前版本（CURRENT）是活跃的版本，所有的读写操作都在这个版本上进行。
- 执行压缩（compaction）操作后，LevelDB会基于当前版本创建一个新的版本，当前版本随之成为历史版本。

**迭代器与版本依赖**:

- 创建的迭代器（Iterator）将依附于创建时的版本。即使该版本后来变成了历史版本，迭代器仍然可以访问它，因为这个版本不会删除。

**版本编辑（VersionEdit）**:

- 版本编辑记录了版本之间的变化，可以看作是版本更新的增量（delta）。
- 版本编辑记录了新增和删除的文件，以及文件之间的合并操作。
- 通过应用版本编辑到当前版本上，可以生成一个新的版本。这个过程可以表示为：Version0 + VersionEdit --> Version1。

**MANIFEST文件**:

- MANIFEST文件是LevelDB的元数据文件，记录了当前版本的所有信息。
- 每当版本发生变化时，新的版本信息就会保存到MANIFEST文件中。
- MANIFEST文件以版本编辑的形式组织，采用日志文件格式，使用日志的读写方式进行操作。
- 每个版本编辑都是一条日志记录，这样MANIFEST文件本身就是一个变更日志。
